<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
      <title>Cyclists' Skin Conductivity in 3D - Netherlands</title>
      <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
      <link rel="shortcut icon" href="img/tl_icon.png" />
      <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.js'></script>
      <!-- <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHTJQBq-WUoU0UgfMGgmg6UqJHuRUj6n0&sensor=false"></script> -->
      <script type="text/html" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHTJQBq-WUoU0UgfMGgmg6UqJHuRUj6n0"></script>
      <script type="text/javascript" src="//maps.googleapis.com/maps/api/js?key=AIzaSyBu_V_VjxdF38X1N6LvehcnOnc2YdjcFUE"></script>

      <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.css' rel='stylesheet' />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.12.1/react.min.js"></script>
        <link href='style.css' rel='stylesheet' />
    <script src="https://code.highcharts.com/highcharts.src.js"></script>
    



    <style>
        body {
              margin: 0;
              padding: 0;
              font-family: 'Helvetica Neue', Helvetica, Arial, Sans-serif;
            }

            #map {
              position: absolute;
              top: 0;
              bottom: 0;
              width: 100%;
            }
            /*#pano {
                float: left;
                height: 100%;
                width: 45%;
            }*/
            #menu {
                position: absolute;
                bottom: 30px;
                left: 10px;
                background: rgba(225, 225, 225, .5);
                /*bottom: -570px;*/
                border: 3px solid #000000;
                padding: 5px 5px;
                /*width: 37%;
                height: 100%;
                right: -100px;*/
                font-family: 'Helvetica Neue', Helvetica, Arial, Sans-serif;
                font-size: 12px;
            }

            h1 {
              font-size: 16px;
              line-height: 16px;
              color:black;
            }

            h2 {
              font-size: 14px;
              line-height: 14px;
              margin-bottom: 8px;
              color:#696969;
            }

            a {
              text-decoration: none;
              color:#2dc4b2;
            }

            #console {
              position: absolute;
              display: block;
              /*textTransform: uppercase;*/
              width: 100%;
              top: 0px;
              /*height: 4px;*/
              background-color: rgba(225, 225, 225, .95);
              padding: 4px 28px;
              font-size: 16px;
              cursor: pointer;
              text-align: center;
              /*background: rgba(225, 225, 225, .55);*/
              border: 1px solid #696969; 
              color: rgb(31,78,102);
              *text-shadow: #343a40 2px 2px;*/
                /*min-width: 100%;
                min-height: 12em;
                position: relative;*/

              /*position: relative;
              top: 10px;
              left: 0;
              width: 200px;
              margin: 10px;
              padding: 10px 10px;
              background: rgba(225, 225, 225, .55);
              border: 3px solid #696969; ;*/
              /*color: #fff;*/
              /*text-shadow: #343a40 2px 2px;*/
                /*min-width: 100%;
                min-height: 12em;
                position: relative;*/
            }
            #legend {
                /* right: 50%;
        margin-right: -250px;*/
              position: fixed;
              /*top: 335px;*/
              width: 200px;
              margin: 10px;
              left: -3px;
              bottom:7%;
              padding: 5px 5px;
              background: transparent;
              /*background: rgba(225, 225, 225, .5);*/
              /*border: 3px solid #000000 ;*/
              /*color: #fff;*/
              /*text-shadow: #343a40 2px 2px;*/
                /*min-width: 100%;
                min-height: 12em;
                position: relative;*/
            }
/*            #github {
              position: fixed;

              width: 200px;
              margin: 10px;
              left:5%;
              bottom:-5%;

              background: transparent;
            }*/
            #github {
              position: fixed;
              bottom: 7px;
              left: 100px;
              fill: #D3D3D3;
            }
            .session {
              margin-bottom: 10px;
              height: 20px;
              width: 100%;
            }

            .row {
              height: 12px;
              width: 100%;
            }

            /*#icon {
              position: absolute;
              bottom: 35px;
              left: 10px;
              color: black;
            }*/
            #sidebar{
              position: absolute;
              padding: 40px 0px;
              top: 5px;
              right: 0;
              bottom: 0;
              width: 300px;
              box-shadow: 0px 2px 5px 0px rgba(0, 0, 0, 0.26);
              display: flex;
              flex-direction: column;
            }

            #pano {
              /*float: left;*/
              height: 50%;
              width: 300px;
            }

            #street-view{height:350px;max-height:50vh;display:none}


            .colors {
              background: linear-gradient(to left, #b2182b, #f4a582, #f7f7f7, #92c5de, #2166ac);
              /*margin-left: 1px;*/
              width: 70%;
              left: 0;
            }
            .label {
              width: 48%;
              display: inline-block;
              text-align: left;
              left: 0;
              font-size: 10px;
              color:#696969;
            }

            #stat {
             position: absolute;
             top: 50%;
             bottom: 0;
             width: 100%;
             height:50%;
             background:#FFF;
             z-index:1000;
             padding: 40px 0px;
           }

          #container {
            height:100%;
            width:100%;
            padding: 40px 0px;
          }
    </style>
</head>
<body>
    <style>
    .mapboxgl-popup {
        max-width: 400px;
        font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
    }
    </style>
    <div id='map'></div>
    <div id='sidebar'>
        <!-- <h1>Choropleth example using Mapbox GL js</h1>
        <h2>Population change, 1990-2000</h2>
        <b id="tooltip-name"></b>
        <b id='tooltip'></b>
        <canvas id="linechart" width="800" height="450"></canvas> -->
        <div id='container'>
          <div id="pano"></div>
        <div id='stat'></div>
        </div>
    </div>
    <button id="icon">
      Switch layers
      </button>
    <div id="street-view"></div>
    <!-- <div id="pano"></div> -->
    <div id='console'>
      MAPPING EMOTION IN 3D: CYCLISTS' SKIN CONDUCTIVITY IN THE NETHERLANDS
      </div>
      <div id='legend'>
      <div class='session'> 
      <h2>Skin Conductivity</h2>
      <div class='row colors'>
      </div>
      <div class='row labels'>
        <div class='label'><b>Calm</b></div>
        <div class='label'><b>Stressed</b></div>
      </div>
      <div id='github'>
        <a href="https://github.com/gcmillar/3D-Buildings-NL" title="Check me out on GitHub" alt="octocat">
            <img src="img/GitHub_Logo_gray.png" width="5%">
        </a>
      </div>
    </a>
</div>
    </div>



<script src="script.js" type="text/javascript"></script>

<script>
var chart;

// Initially
mapboxgl.accessToken = 'pk.eyJ1IjoiZ2NtaWxsYXIiLCJhIjoiY2pvcDhrbGl4MDFvaTNrczR0d2hxcjdnNSJ9.JYgBw6y2pEq_AEAOCaoQpw';
let map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/mapbox/streets-v9', 
  center: [5.065, 51.5775],
  zoom: 16.5,
  pitch: 100,
  tilt: 100,
});


// The 'building' layer in the mapbox-streets vector source contains building-height
// data from OpenStreetMap.
map.on('load', function() {
    // Insert the layer beneath any symbol layer.
    var layers = map.getStyle().layers;
    window.setInterval(function() {
        map.getSource('pt1_geojson_conduct-time').setData(url);
    }, 2000);

    map.addSource('pt1_geojson_conduct-time', { type: 'geojson', data: url });
    var layers = map.getStyle().layers;
    map.addLayer({
        'id': '3d-buildings',
        'source': 'composite',
        'source-layer': 'building',
        'filter': ['==', 'extrude', 'true'],
        'type': 'fill-extrusion',
        'minzoom': 12,
        'paint': {
            'fill-extrusion-color': '#c6bdff',

            // use an 'interpolate' expression to add a smooth transition effect to the
            // buildings as the user zooms in
            'fill-extrusion-height': [
                "interpolate", ["linear"], ["zoom"],
                10, 0,
                10.05, ["get", "height"]
            ],
            'fill-extrusion-base': [
                "interpolate", ["linear"], ["zoom"],
                10, 0,
                10.05, ["get", "min_height"]
            ],
            'fill-extrusion-opacity': .5
        }
    }, labelLayerId);
    map.addLayer({
        "id": "pt1_geojson_conduct-time",
        "type": "circle",
        "source": "pt1_geojson_conduct-time",
        "paint": {
            "circle-radius": {
                'base': 6,
                'stops': [[12, 6], [70, 350]],
            },
            "circle-opacity": 1,
            "circle-color": {
              property: 'conductance_z',
              type: 'exponential',
              stops: [
                [-12361.2246720,'#2166ac'],
                // [-0.8704912, '#d6604d']
                // [-0.5898474, '#4393c3'],
                // [-0.2839074, '#fddbc7'],
                [0.1773300, '#92c5de'],
                // [0.3573693, '#d1e5f0'],
                // [0.6403849, '#f7f7f7'],
                [2647.7223040, '#f4a582'],
                [28208.5369920, '#b2182b'],
                // ["grey"]
                ]
            }
        }
    }, labelLayerId);

    // When a click event occurs on a feature in the places layer, open a popup at the
    // location of the feature, with description HTML from its properties.
    map.on('click', 'pt1_geojson_conduct-time', function (e) {
        var coordinates = e.features[0].geometry.coordinates.slice();
        var description = e.features[0].properties.conductance_z;

        // Ensure that if the map is zoomed out such that multiple
        // copies of the feature are visible, the popup appears
        // over the copy being pointed to.
        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
        }

        new mapboxgl.Popup({closeOnClick: true})
            .setLngLat(coordinates)
            // .setHTML(panorama)
            .setHTML('Skin Conductivity: ' + description) // + panorama
            // .setHTML(new mapboxgl.Popup(panorama)) // add street view popup
            .addTo(map);

        panorama = new google.maps.StreetViewPanorama(document.getElementById('pano'), {
          position: { lng: 5.080000, lat: 51.596000 },
          pov: { heading: 165, pitch: 0 },
          addressControl: false,
          linksControl: true, // guide arrows
          panControl: false, // compass
          zoomControl: false,
          /*
          zoomControlOptions: {
              position: google.maps.ControlPosition.LEFT_TOP
          },*/
          fullscreenControl: true,
          fullscreenControlOptions: {
              position: google.maps.ControlPosition.LEFT_TOP
          },
          zoom: 5,
          visible: true,
          mode: 'html5' // fixes bug in FF: http://stackoverflow.com/questions/28150715/remove-google-street-view-panorama-effect
      });    

        panorama.setPov({
          heading: +coordinates.heading || 0,
          pitch: +coordinates.pitch || 0,
          zoom: +coordinates.zoom || 1
        });
        panorama.setPosition({
          lng: +coordinates.lng,
          lat: +coordinates.lat
        });

        // NOTE: this fixes broken behavior:
        panorama.setVisible(false);
        panorama.setVisible(true);

        // new google.maps.StreetViewPanorama(document.getElementById('pano'), {
        //   // position: coordinates, 
        //   position : {
        //   lat : parseFloat( e.lngLat.lat ),
        //   lng : parseFloat( e.lngLat.lng )
        //   },
        //   pov: { heading: 165, pitch: 0 },
        //   addressControl: false,
        //   linksControl: true, // guide arrows
        //   panControl: false, // compass
        //   zoomControl: false,
          
        //   zoomControlOptions: {
        //       position: google.maps.ControlPosition.LEFT_TOP
        //   },
        //   fullscreenControl: true,
        //   fullscreenControlOptions: {
        //       position: google.maps.ControlPosition.LEFT_TOP
        //   },
        //   zoom: 5,
        //   visible: true,
        //   mode: 'html5' // fixes bug in FF: http://stackoverflow.com/questions/28150715/remove-google-street-view-panorama-effect
        // });    

        // panorama = new google.maps.StreetViewPanorama(document.getElementById('pano'), {
        //   position: { lng: 5.080000, lat: 51.596000 }, 
        //   pov: { heading: 165, pitch: 0 },
        //   addressControl: false,
        //   linksControl: true, // guide arrows
        //   panControl: false, // compass
        //   zoomControl: false,
          
        //   zoomControlOptions: {
        //       position: google.maps.ControlPosition.LEFT_TOP
        //   },
        //   fullscreenControl: true,
        //   fullscreenControlOptions: {
        //       position: google.maps.ControlPosition.LEFT_TOP
        //   },
        //   zoom: 5,
        //   visible: true,
        //   mode: 'html5' // fixes bug in FF: http://stackoverflow.com/questions/28150715/remove-google-street-view-panorama-effect
        // });

        // panorama.setPov({
        // heading: +coordinates.heading || 0,
        // pitch: +coordinates.pitch || 0,
        // zoom: +coordinates.zoom || 1
        // });
        // panorama.setPosition({
        //     lng: +coordinates,
        //     lat: +coordinates
        // });

        // // NOTE: this fixes broken behavior:
        // panorama.setVisible(false);
        // panorama.setVisible(true);    

        // panorama.setPano(coordinates.pano);
        // panorama.setPov({
        //   heading: 270,
        //   pitch: 0
        // });
        // panorama.setVisible(true);

          // var markerPanoID = coordinates.pano;
          // // Set the Pano to use the passed panoID.
          // panorama.setPano(markerPanoID);
          // panorama.setPov({
          //   heading: 270,
          //   pitch: 0
          // });
          // panorama.setVisible(true);    

        // function initialize() {
        //   var fenway = new google.maps.LatLng(51.596000, 5.080000); 
        //   var panoramaOptions = {
        //     position: fenway,
        //     pov: {
        //       heading: 225,
        //       pitch: 20
        //     },
        // linksControl: false,
        // scrollwheel: false,
        // clickToGo: true
        //   };
        //   var panorama = new google.maps.StreetViewPanorama(document.getElementById('panorama'), panoramaOptions);
        // }

        // google.maps.event.addDomListener(window, 'load', initialize);

    });

    // Change the cursor to a pointer when the mouse is over the places layer.
    map.on('mouseenter', 'pt1_geojson_conduct-time', function () {
        map.getCanvas().style.cursor = 'pointer';
    });

    // Change it back to a pointer when it leaves.
    map.on('mouseleave', 'pt1_geojson_conduct-time', function () {
        map.getCanvas().style.cursor = '';
    });

    var labelLayerId;
    for (var i = 0; i < layers.length; i++) {
        if (layers[i].type === 'symbol' && layers[i].layout['text-field']) {
            labelLayerId = layers[i].id;
            break;
        }
    }
    let icon = document.getElementById('icon');

    icon.addEventListener('click', function(e) {
      map.setStyle('mapbox://styles/mapbox/dark-v9');
      }, false)

    



    // Add zoom and rotation controls to the map.
    map.addControl(new mapboxgl.NavigationControl());

    // chartInit()

  map.on("render", chartSetData);

});


// function getData() {
//   var vals = [];
//   var layer = "pt1_geojson_conduct-time"
//   if (!map.getLayer(layer)) return vals;

//   var test = map.queryRenderedFeatures({
//     layers: [layer]
//   });

//   test.forEach(function(f) {
//     vals.push([f.properties.time, f.properties.conductance_z]);
//   })

//   vals = vals.sort(function(a, b) {

//     return a[0] - b[0];
//   })

//   return (vals);
// }




// function chartSetData() {
//   data = getData();

//   if (!data || data.length == 0) return;

//   chart.series[0].update({
//     data: data
//   })


// }

// function chartInit(data) {

//   data = data || getData() || [];

//   Highcharts.createElement('link', {
//     href: 'https://fonts.googleapis.com/css?family=Unica+One',
//     rel: 'stylesheet',
//     type: 'text/css'
//   }, null, document.getElementsByTagName('head')[0]);

//   Highcharts.theme = {
//     colors: ['rgba(31, 78, 102, .35)', '#90ee7e', '#f45b5b', '#7798BF', '#aaeeee', '#ff0066', '#eeaaee',
//       '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'
//     ],
//     chart: {
//       backgroundColor: {
//         linearGradient: {
//           x1: 0,
//           y1: 0,
//           x2: 1,
//           y2: 1
//         },
//         stops: [
//           [0, 'rgba(225, 225, 225, .55)'],
//           [1, 'rgba(225, 225, 225, .55)']
//         ]
//       },
//       style: {
//         fontFamily: 'Helvetica Neue, Arial, Helvetica, sans-serif;'
//       },
//       plotBorderColor: '#606063'
//     },
//     title: {
//       style: {
//         color: '#000000',
//         textTransform: 'uppercase',
//         fontSize: '20px'
//       }
//     },
//     subtitle: {
//       style: {
//         color: '#000000',
//         textTransform: 'uppercase'
//       }
//     },
//     xAxis: {
//       gridLineColor: '#707073',
//       labels: {
//         style: {
//           color: '#000000'
//         }
//       },
//       lineColor: '#707073',
//       minorGridLineColor: '#505053',
//       tickColor: '#707073',
//       title: {
//         style: {
//           color: '#000000'

//         }
//       }
//     },
//     yAxis: {
//       gridLineColor: '#707073',
//       labels: {
//         style: {
//           color: '#000000'
//         }
//       },
//       lineColor: '#707073',
//       minorGridLineColor: '#505053',
//       tickColor: '#707073',
//       tickWidth: 1,
//       title: {
//         style: {
//           color: '#000000'
//         }
//       }
//     },
//     tooltip: {
//       backgroundColor: 'rgba(0, 0, 0, 0.85)',
//       style: {
//         color: '#F0F0F0'
//       }
//     },
//     plotOptions: {
//       series: {
//         dataLabels: {
//           color: '#B0B0B3'
//         },
//         marker: {
//           lineColor: '#333'
//         }
//       },
//       boxplot: {
//         fillColor: 'blue'
//       },
//       candlestick: {
//         lineColor: 'white'
//       },
//       errorbar: {
//         color: 'white'
//       }
//     },
//     legend: {
//       itemStyle: {
//         color: '#E0E0E3'
//       },
//       itemHoverStyle: {
//         color: '#FFF'
//       },
//       itemHiddenStyle: {
//         color: '#606063'
//       }
//     },
//     credits: {
//       style: {
//         color: '#666'
//       }
//     },
//     labels: {
//       style: {
//         color: '#707073'
//       }
//     },

//     drilldown: {
//       activeAxisLabelStyle: {
//         color: '#F0F0F3'
//       },
//       activeDataLabelStyle: {
//         color: '#F0F0F3'
//       }
//     },

//     navigation: {
//       buttonOptions: {
//         symbolStroke: '#DDDDDD',
//         theme: {
//           fill: '#505053'
//         }
//       }
//     },

//     // scroll charts
//     rangeSelector: {
//       buttonTheme: {
//         fill: '#505053',
//         stroke: '#000000',
//         style: {
//           color: '#CCC'
//         },
//         states: {
//           hover: {
//             fill: '#707073',
//             stroke: '#000000',
//             style: {
//               color: 'white'
//             }
//           },
//           select: {
//             fill: '#000003',
//             stroke: '#000000',
//             style: {
//               color: 'white'
//             }
//           }
//         }
//       },
//       inputBoxBorderColor: '#505053',
//       inputStyle: {
//         backgroundColor: '#333',
//         color: 'silver'
//       },
//       labelStyle: {
//         color: 'silver'
//       }
//     },

//     navigator: {
//       handles: {
//         backgroundColor: '#666',
//         borderColor: '#AAA'
//       },
//       outlineColor: '#CCC',
//       maskFill: 'rgba(255,255,255,0.1)',
//       series: {
//         color: '#7798BF',
//         lineColor: '#A6C7ED'
//       },
//       xAxis: {
//         gridLineColor: '#505053'
//       }
//     },

//     scrollbar: {
//       barBackgroundColor: '#808083',
//       barBorderColor: '#808083',
//       buttonArrowColor: '#CCC',
//       buttonBackgroundColor: '#606063',
//       buttonBorderColor: '#606063',
//       rifleColor: '#FFF',
//       trackBackgroundColor: '#404043',
//       trackBorderColor: '#404043'
//     },

//     // special colors for some of the
//     legendBackgroundColor: 'rgba(0, 0, 0, 0.5)',
//     background2: '#505053',
//     dataLabelsColor: '#B0B0B3',
//     textColor: '#C0C0C0',
//     contrastTextColor: '#F0F0F3',
//     maskColor: 'rgba(255,255,255,0.3)'
//   };

//   // Apply the theme
//   Highcharts.setOptions(Highcharts.theme);


//   chart = Highcharts.chart('container', {
//     chart: {
//       zoomType: 'x',
//       events: {
//         selection: function(event) {
//             var layer = "pt1_geojson_conduct-time";
          
//           if(event.resetSelection){
//                map.setFilter(layer,[
//             'all'
//           ])
            
//           }else{
//           var ext = event.xAxis[0];
         
//           map.setFilter(layer,[
//             'all',
//             ['<','time',ext.max],
//             ['>','time',ext.min]
//           ])
//           }
//         }
//       }
//     },
//     title: {
//       text: 'Skin Conductivity'
//     },
//     subtitle: {
//       text: 'Click & drag to filter'
//     },
//     xAxis: {
//       title: {
//         text: 'Cycling Time (s)'
//     }
//     },
//     yAxis: {
//       title: {
//         text: 'Conductivity'
//       }
//     },
//     legend: {
//       enabled: false
//     },

//     plotOptions: {
//       line: {
//         fillColor: {
//           // linearGradient: {
//           //   x1: 0,
//           //   y1: 0,
//           //   x2: 0,
//           //   y2: 1
//           // },
//           stops: [
//           [-12361.2246720,'rgba(33, 102, 172, .55)'], 
//           // [-0.8704912, '#d6604d']
//           // [-0.5898474, '#4393c3'],
//           // [-0.2839074, '#fddbc7'],
//           // [0.1773300, 'rgba(146,197,222, .55)'],
//           // // [0.3573693, '#d1e5f0'],
//           // // [0.6403849, '#f7f7f7'],
//           // [2647.7223040, 'rgba(244,165,130, .55)'],
//           [28208.5369920, 'rgba(178,24,43, .55)'] 
//           // [0, Highcharts.getOptions().colors[0]],
//           // [1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]
//           ]
//         },
//       },
//       // area: {
//       //   fillColor: {
//       //     linearGradient: {
//       //       x1: 0,
//       //       y1: 0,
//       //       x2: 0,
//       //       y2: 1
//       //     },
//       //     stops: [
//       //   //   [0,'rgba(33, 102, 172, .55) : rgba(178,24,43, .55)']
//       //     // [-0.8704912, '#d6604d']
//       //     // [-0.5898474, '#4393c3'],
//       //     // [-0.2839074, '#fddbc7'],
//       //     // [0, 'rgba(146,197,222, .55)'],
//       //     // [0.3573693, '#d1e5f0'],
//       //     // [0.6403849, '#f7f7f7'],
//       //     // [2647.7223040, 'rgba(244,165,130, .55)'],
//       //     // [1, 'rgba(178,24,43, .55)'] 
//       //     [0, Highcharts.getOptions().colors[0]],
//       //     [1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]
//       //     ]
//       //   },
//       //   marker: {
//       //     radius: 2
//       //   },
//       //   lineWidth: 3,
//       //   states: {
//       //     hover: {
//       //       lineWidth: 2
//       //     }
//       //   },
//       //   threshold: null
//       // }
//     },

//     series: [{
//       type: 'area',
//       name: 'Skin Conductivity',
//       data: data
//     }]
//   });


// }






// function rCoord() {
//   var coord = [
//     (Math.random() * 360) - 180, (Math.random() * 180) - 90
//   ]
//   return coord
// }

// function rDate(base) {
//   base = base || 0;
//   mx = new Date();
//   mn = new Date("2004/12/02");
//   dd = Math.round(mx - (Math.random() * (mx - mn - base)));
//   return (dd)
// }

// function rProp(base) {
//   base = base || [0];
//   var a = (base[0] + 180) / 360 || Math.random();

//   var prop = {
//     date: rDate(a * 1000),
//     nHgKg: Math.round(a * 1000)
//   }

//   return prop;
// }

// function rPoint() {
//   var coord = rCoord()
//   var point = {
//     type: "Feature",
//     geometry: {
//       type: "Point",
//       coordinates: coord
//     },
//     properties: rProp(coord)
//   }
//   return point;
// }

// function rPoints(n) {
//   var gJson = {
//     type: "FeatureCollection",
//     features: []
//   };
//   n = n || 100;
//   for (var i = 0; i < n; i++) {
//     gJson.features.push(rPoint());
//   }
//   return gJson;
// }


// function cloneArray(arr) {
//   var i = arr.length;
//   var clone = [];
//   while (i--) {
//     clone[i] = arr[i];
//   }
//   return (clone);
// };

// function getArrayStat(o) {

//   if (
//     o.arr === undefined ||
//     o.arr.constructor != Array ||
//     o.arr.length === 0
//   ) return [];

//   if (
//     o.stat == "quantile" &&
//     o.percentile &&
//     o.percentile.constructor == Array
//   ) o.stat = "quantiles";

//   var arr = cloneArray(o.arr);
//   var stat = o.stat ? o.stat : "max";
//   var len_o = arr.length;
//   var len = len_o;

//   function sortNumber(a, b) {
//     return a - b;
//   }

//   opt = {
//     "max": function() {
//       var max = -Infinity;
//       var v = 0;
//       while (len--) {
//         v = arr.pop();
//         if (v > max) {
//           max = v;
//         }
//       }
//       return max;
//     },
//     "min": function() {
//       var min = Infinity;
//       while (len--) {
//         v = arr.pop();
//         if (v < min) {
//           min = v;
//         }
//       }
//       return min;
//     },
//     "sum": function() {
//       var sum = 0;
//       while (len--) {
//         sum += arr.pop();
//       }
//       return sum;
//     },
//     "mean": function() {
//       var sum = getArrayStat({
//         stat: "sum",
//         arr: arr
//       });
//       return sum / len_o;
//     },
//     "median": function() {
//       var median = getArrayStat({
//         stat: "quantile",
//         arr: arr,
//         percentile: 50
//       });
//       return median;
//     },
//     "quantile": function() {
//       arr.sort(sortNumber);
//       o.percentile = o.percentile ? o.percentile : 50;
//       index = o.percentile / 100 * (arr.length - 1);
//       if (Math.floor(index) == index) {
//         result = arr[index];
//       } else {
//         i = Math.floor(index);
//         fraction = index - i;
//         result = arr[i] + (arr[i + 1] - arr[i]) * fraction;
//       }
//       return result;
//     },
//     "quantiles": function() {
//       var quantiles = {};
//       o.percentile.forEach(function(x) {
//         var res = getArrayStat({
//           stat: "quantile",
//           arr: arr,
//           percentile: x
//         });
//         quantiles[x] = res;
//       });
//       return quantiles;
//     },
//     "distinct": function() {
//       var n = {},
//         r = [];

//       while (len--) {
//         if (!n[arr[len]]) {
//           n[arr[len]] = true;
//           r.push(arr[len]);
//         }
//       }
//       return r;
//     }
//   };

//   return (opt[stat](o));

// };



// function printLayerStat() {

//   var s = getLayerStat();

//   var elN = document.getElementById("sN");
//   var elMin = document.getElementById("sMin");
//   var elMax = document.getElementById("sMax");
//   var elPtil = document.getElementById("sPtil");

//   elN.innerHTML = s.n;
//   elMin.innerHTML = s.min;
//   elMax.innerHTML = s.max;
//   elPtil.innerHTML = JSON.stringify(s.ptil);

// }


// function getLayerStat() {
//   var test = map.queryRenderedFeatures({
//     layers: ["pt1_geojson_conduct-time"] 
//   });
//   var vals = [];
//   test.forEach(function(f) {
//     vals.push([
//       f.properties.time,
//       f.properties.conductance_z
//     ]);
//   })
//   var out = {
//     n: test.length,
//     max: getArrayStat({
//       arr: vals,
//       stat: 'max'
//     }),
//     min: getArrayStat({
//       arr: vals,
//       stat: 'min'
//     }),
//     ptil: getArrayStat({
//       arr: vals,
//       stat: 'quantiles',
//       percentile: [25, 50, 75]
//     })
//   }
//   return (out)
// }



var url = 'https://raw.githubusercontent.com/gcmillar/3D-Buildings-NL/master/pt1_geojson_conduct-time';

</script>

<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHTJQBq-WUoU0UgfMGgmg6UqJHuRUj6n0&callback=initialize">
</script>

<script type="text/html" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBHTJQBq-WUoU0UgfMGgmg6UqJHuRUj6n0"></script>


</body>

</html>
